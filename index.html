<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ke's Moments | Living Softly</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Noto+Sans+TC:wght@300;400&display=swap" rel="stylesheet">
    <style>
        :root { --nordic-beige: #F5EBE0; --nordic-dark: #4E4941; --nordic-accent: #D5BDAF; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--nordic-beige); color: var(--nordic-dark); }
        .serif { font-family: 'DM Serif Display', serif; }
        .input-focus:focus { outline: none; border-color: var(--nordic-accent); ring: 1px var(--nordic-accent); }
        .glass-card { background: rgba(255, 255, 255, 0.6); backdrop-filter: blur(10px); border-radius: 24px; }
    </style>
</head>
<body class="pb-20">

    <header class="max-w-4xl mx-auto pt-20 pb-12 px-6 text-center">
        <h1 class="serif text-5xl mb-4 tracking-tight">Ke's Moments</h1>
        <nav class="text-xs uppercase tracking-[0.3em] text-stone-400">
            Travel / Sports / <span class="text-stone-600">Murmurs</span>
        </nav>
    </header>

    <section class="max-w-2xl mx-auto px-6 mb-20">
        <div class="glass-card p-8 border border-white/40 shadow-sm">
            <h3 class="serif text-xl mb-6">Capture a moment</h3>
            <form id="journalForm" class="space-y-4">
                <input type="text" id="title" placeholder="標題..." class="w-full bg-transparent border-b border-stone-300 py-2 input-focus" required>
                <textarea id="content" rows="3" placeholder="此刻的想法..." class="w-full bg-transparent border-b border-stone-300 py-2 input-focus" required></textarea>
                <div class="grid grid-cols-2 gap-4">
                    <select id="category" class="bg-transparent border-b border-stone-300 py-2 text-sm input-focus">
                        <option value="Travel">Travel</option>
                        <option value="Sports">Sports</option>
                        <option value="Murmurs">Murmurs</option>
                    </select>
                    <input type="text" id="image" placeholder="圖片網址 (選填)..." class="bg-transparent border-b border-stone-300 py-2 text-sm input-focus">
                </div>
                <button type="submit" class="w-full mt-4 py-3 bg-stone-800 text-white rounded-full hover:bg-stone-700 transition duration-300 text-sm tracking-widest">PUBLISH</button>
            </form>
            <p id="msg" class="text-center mt-4 text-xs text-stone-400 hidden italic"></p>
        </div>
    </section>

    <main id="moments-grid" class="max-w-4xl mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-8">
        </main>

    <script>
        const API_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL';

        // 提交表單
        document.getElementById('journalForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const msg = document.getElementById('msg');
            btn.disabled = true;
            btn.innerText = 'SAVING...';

            const formData = {
                title: document.getElementById('title').value,
                content: document.getElementById('content').value,
                category: document.getElementById('category').value,
                image: document.getElementById('image').value,
                date: new Date().toISOString()
            };

            try {
                await fetch(API_URL, {
                    method: 'POST',
                    mode: 'no-cors', // 必須使用 no-cors
                    body: JSON.stringify(formData)
                });
                msg.innerText = "已存入 Google Sheets，請重新整理網頁查看。";
                msg.classList.remove('hidden');
                e.target.reset();
            } catch (err) {
                alert('發布失敗，請檢查 API 設定');
            } finally {
                btn.disabled = false;
                btn.innerText = 'PUBLISH';
            }
        };

        // 讀取內容
        async function load() {
            const res = await fetch(API_URL);
            const data = await res.json();
            const container = document.getElementById('moments-grid');
            container.innerHTML = data.reverse().map(item => `
                <div class="group cursor-default">
                    ${item.Image ? `<img src="${item.Image}" class="w-full h-72 object-cover rounded-[2rem] mb-4 grayscale-[30%] group-hover:grayscale-0 transition duration-700 shadow-sm">` : ''}
                    <div class="px-2">
                        <div class="flex justify-between text-[10px] text-stone-400 mb-2 uppercase tracking-widest">
                            <span>${item.Category}</span>
                            <span>${new Date(item.Date).toLocaleDateString()}</span>
                        </div>
                        <h2 class="serif text-2xl text-stone-800 mb-3">${item.Title}</h2>
                        <p class="text-sm text-stone-500 leading-relaxed font-light">${item.Content}</p>
                    </div>
                </div>
            `).join('');
        }
        load();
    </script>
</body>
</html>
